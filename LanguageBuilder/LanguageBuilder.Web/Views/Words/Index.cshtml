@model SearchViewModel

@{
    ViewData["Title"] = "Words";
}

<h2>Index</h2>

@await Component.InvokeAsync(nameof(BootstrapAlertComponent), 
    TempData[WebConstants.AlertKey] as BootstrapAlertViewModel)

<p>
    <a asp-action="Create">Create New</a>
</p>
<table class="table">
    <thead>
        <tr>
                <th>
                    @Html.Display("Gender")
                </th>
                <th>
                    @Html.Display("Type")
                </th>
                <th>
                    @Html.Display("Content")
                </th>
            <th>
                @Html.Display("Language")
            </th>
            <th></th>
        </tr>
    </thead>
    <tbody>
@foreach (var item in Model.Words) {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.Gender)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.SyntaxType)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Content)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Language.Name)
            </td>
            <td>
                <a asp-action="Edit" asp-route-id="@item.Id">Edit</a> |
                <a asp-action="Details" asp-route-id="@item.Id">Details</a> |
                <a asp-action="Details" asp-route-id="@item.Id" class="btn-delete" data-id="@item.Id">Delete</a>
            </td>
        </tr>
}
    </tbody>
</table>

@await Component.InvokeAsync(
    nameof(BootstrapModalComponent),
    new BootstrapModalViewModel()
    {
        Body = "Do you want to delete this word.",
        ConfirmButtonName = "Yes",
        Title = "Confirm delete",
        CancelButtonName = "No",
        Id = "delete-modal",
        ConfirmButtonId = "modal-confirm"
    })

@section Scripts {
    <script type="text/javascript">

        $(document).ready(function () {

            var dialog = $('#delete-modal').modal({ show: false });
            var clickedWord = undefined;

            $('.btn-delete').on('click', function (event) {
                event.preventDefault();
                clickedWord = $(event.target)
                dialog.modal().show();
            });

            $('#modal-confirm').on('click', function (event) {
                $.ajax({
                    type: "GET",
                    url: '/Words/DeleteConfirmed/' + clickedWord.data('id'),
                    data: {},
                    success: undefined
                });
            });

        });
    </script>
}
